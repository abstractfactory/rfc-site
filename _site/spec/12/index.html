
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/assets/img/ico/favicon.ico">

    <title>Abstract Factory</title>

    <!-- Bootstrap core CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">

    <link href="/assets/css/styles.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

        <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Abstract Factory</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class=""><a href="/">RFC</a></li>
            <li class=""><a href="/about/">About</a></li>
            <li class=""><a href="/contact/">Contact</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>




    <div class="container">

      <div class="spec-container row">
	<div class="col-md-4">
		<div class="toc">
		</div>
	</div>

	<div class="col-md-7 col-md-offset-1">
	<h1 id="toc_0">Object-Oriented Metadata (OOM)</h1>

<p>An extension to Open Metadata to support the notion of inheritance.</p>

<p><img src="https://dl.dropbox.com/s/2eyg655o4cws97t/oom_place_v001.png" alt=""></p>

<ul>
<li>Name: https://github.com/abstract-factory/rfc/spec:12 (11/MCE)</li>
<li>Editor: Marcus Ottosson <a href="mailto:marcus@abstractfactory.io">marcus@abstractfactory.io</a></li>
<li>Inherits: RFC1</li>
<li>State: draft</li>
</ul>

<h1 id="toc_1">Goal</h1>

<p>Open Metadata is a method for storing generic data within folders on your hard-drive. This document describes a method that defines each folder as an object within an inheritance-tree; each folder inheriting from its parent.</p>

<p>The result of this is a cascading behaviour in attributes from top to bottom within a hierarchy.</p>

<h3 id="toc_2">When to use</h3>

<p>When is inheritance in information intuitive? Well, consider configuration files of software. Consider Sublime Text. In Sublime, you have Configuration Files (CF) and then you have User Configuration Files (UCF). The information within UCF augments and, perhaps more importantly, overrides the CF. You may copy certain information over from the CF into the UCF in order to make alterations and you may add your own configuration that would augment the original configuration.</p>

<h3 id="toc_3">When not to use</h3>

<p>Inheritance is not suited to all types of information. Consider the description of the folder &quot;my mp3 collection&quot;. This description is singular and does not apply to any descenants in a hierarchy; like &quot;best of bon jovi&quot;.</p>

<h1 id="toc_4">Architecture</h1>

<p>OOM extends Open Metadata with the <code>Instance</code> and <code>Attribute</code> objects and an <code>inherit()</code> method. Open Metadata defines <code>om.pull()</code> as a means of reading from disk; <code>om.inherit()</code> pulls data from both current and ascending folders. <code>Instance</code> then wraps <code>om.Group</code> to replicate the interface of a regular plain-data-type programming object.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">config</span> <span class="o">=</span> <span class="n">oom</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s">r&#39;c:\users\marcus\sublime&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">config</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;spell_correction&#39;</span><span class="p">]</span>
</code></pre></div>
<p>With <code>oom.inherit()</code>, each folder may be thought of as a subclass of its parent, passing on and potentially overriding information from parent to child; just as you would expect from regular inheritance in Object-oriented languages such as Python or C++.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">userconfig</span> <span class="o">=</span> <span class="n">oom</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s">r&#39;c:\users\marcus\sublime\user&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">oom</span><span class="o">.</span><span class="n">inherit</span><span class="p">(</span><span class="n">userconfig</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">userconfig</span><span class="o">.</span><span class="n">plugins</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;my_custom_plugin&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">userconfig</span><span class="o">.</span><span class="n">plugins</span>
<span class="p">[</span><span class="s">&#39;spell_correction&#39;</span><span class="p">,</span> <span class="s">&#39;my_custom_plugin&#39;</span><span class="p">]</span>
</code></pre></div>
<h2 id="toc_5"><a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov Substitution Principle</a></h2>

<p>Inheritance is additive. It may be easier to think of inheritance as being cascading. Cascading inheritance enforces the LSP in that however you edit children, a parent may always be replaced by its child.</p>

<p>This is an important concept in a progammable hierarchy and one that is enforced in the design of OOM. If a child were to be given the ability to break the LSP, then you could never be sure at which point in your hierarchy your code will fail.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">oom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">userconfig</span><span class="o">.</span><span class="n">plugins</span><span class="p">)</span>
</code></pre></div>
<h2 id="toc_6">Difference between <code>Group</code> and <code>Instance</code></h2>

<p><code>Instance</code> is essentially a <code>Group</code>, with a few minor differences.</p>

<ol>
<li><code>Group</code> does not take into account ascending parent-hood.</li>
<li><code>Group</code> cannot have its members accessed via dot-notation.</li>
<li>and thus <code>Group</code> cannot have its members modified directly.</li>
</ol>

<h2 id="toc_7">Designed for inheritance</h2>

<p>In the above example, how would you go about <em>removing</em> or <em>altering</em> inherited information? Consider the following example</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">project</span> <span class="o">=</span> <span class="n">oom</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s">r&#39;/project&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">project</span><span class="o">.</span><span class="n">executables</span>
<span class="p">[</span><span class="s">&#39;maya&#39;</span><span class="p">,</span> <span class="s">&#39;houdini&#39;</span><span class="p">]</span>
</code></pre></div>
<p>Underneath &#39;project&#39; we have &#39;shot5&#39;, but we don&#39;t want &#39;maya&#39; to be part of &#39;shot5&#39;, so what do we do?</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">project</span> <span class="o">=</span> <span class="n">oom</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s">&#39;/project&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">project</span><span class="o">.</span><span class="n">executables</span>
<span class="p">{</span><span class="s">&#39;maya&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;houdini&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
</code></pre></div>
<p>Now both &#39;maya&#39; and &#39;houdini&#39; have a bool value specifying whether or not they are active. Inactivating any executable is now a matter of:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">shot</span> <span class="o">=</span> <span class="n">oom</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s">&#39;/project/shot5&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">shot</span><span class="o">.</span><span class="n">executables</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;maya&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">shot</span><span class="o">.</span><span class="n">executables</span>
<span class="p">{</span><span class="s">&#39;maya&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;houdini&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
</code></pre></div>
<h3 id="toc_8">Selective inheritance</h3>

<p>What about situations where you aren&#39;t looking to inherit <em>every</em> member of an instance? This is the recommended way with which to retrieve metadata in an inheritance manner as it greatly decreases the amount of reading done in each query.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">shot</span> <span class="o">=</span> <span class="n">oom</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s">&#39;/project/shot5&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">oom</span><span class="o">.</span><span class="n">inherit</span><span class="p">(</span><span class="n">shot</span><span class="o">.</span><span class="n">executables</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">shot</span><span class="o">.</span><span class="n">executables</span>
<span class="p">{</span><span class="s">&#39;maya&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;houdini&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
</code></pre></div>
<h3 id="toc_9">Shallow inheritance</h3>

<p>How about situations where you may only be interested in an immediate parent, and not any of the parents above?</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">oom</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">oom</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">oom</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">oom</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s">&#39;/project&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">shot</span> <span class="o">=</span> <span class="n">oom</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="s">&#39;/project/shot5&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">oom</span><span class="o">.</span><span class="n">inherit</span><span class="p">(</span><span class="n">shot</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">shot</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s">&#39;c&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">shot</span><span class="o">.</span><span class="n">data</span>
<span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">]</span>
</code></pre></div>
<h1 id="toc_10">Implementation</h1>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="c"># Psuedo-code</span>
<span class="k">class</span> <span class="nc">Instance</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">:</span>
        <span class="n">children</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">inherited_children</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">inherited_children</span> <span class="o">+</span> <span class="n">children</span>
</code></pre></div>
<p>Each Instance contain a <code>inherited_children</code> member which is mostly empty when not utilising <code>oom.inherit()</code></p>

<p>After <code>oom.inherit()</code> <code>inherited_children</code> is populated with.. inherited children (i.e. data) that is added upon query, but not altered upon edit.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="c"># This will add &#39;5&#39; to &#39;instance&#39;, but won&#39;t remove inherited data</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">instance</span><span class="o">.</span><span class="n">data</span>
<span class="p">[</span><span class="s">&#39;hello&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">instance</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">instance</span><span class="o">.</span><span class="n">data</span>
<span class="p">[</span><span class="s">&#39;hello&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</code></pre></div>
<h3 id="toc_11">Inheritance by either Instance or Attribute</h3>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="k">def</span> <span class="nf">inherit_instance</span><span class="p">()</span>
   <span class="k">pass</span>

<span class="k">def</span> <span class="nf">inherit_attribute</span><span class="p">()</span>
   <span class="k">pass</span>

<span class="k">def</span> <span class="nf">inherit</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
   <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Instance</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">inherit_instance</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
   <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Attribute</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">inherit_attribute</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
   <span class="k">raise</span> <span class="ne">TypeError</span>
</code></pre></div>
	</div>
</div>

    
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/plugins.js"></script>
    <script src="/assets/js/main.js"></script>
  </body>
</html>
